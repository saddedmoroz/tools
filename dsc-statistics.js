// ==UserScript==
// @name			DSC: статистика
// @version			1.3
// @description		21-12-2024
// @updateURL		https://raw.githubusercontent.com/saddedmoroz/tools/master/dsc-statistics.js
// @downloadURL		https://raw.githubusercontent.com/saddedmoroz/tools/master/dsc-statistics.js
// @author			saddedmoroz
// @match			https://centiman.avito.ru/service-dataset-collector-frontend/*
// ==/UserScript==

/*
	Отображает статистику в верхней панели.
	При клике по названию показатель будет сброшен на 0.
	При клике по времени будет скрыт встроенный счётчик.
	При возникновении ошибок попробовать нажать Выход в правом верхнем углу и войти заново.
*/

'use strict';

const _0x1633a6=_0x4e16;(function(_0x4ceca0,_0x404e4f){const _0x193df6=_0x4e16,_0x360ca2=_0x4ceca0();while(!![]){try{const _0xde0b84=-parseInt(_0x193df6(0x1d7))/0x1+parseInt(_0x193df6(0x1cb))/0x2*(parseInt(_0x193df6(0x1d1))/0x3)+parseInt(_0x193df6(0x1ca))/0x4+-parseInt(_0x193df6(0x1cc))/0x5*(-parseInt(_0x193df6(0x1ad))/0x6)+-parseInt(_0x193df6(0x1cd))/0x7+-parseInt(_0x193df6(0x1ac))/0x8+parseInt(_0x193df6(0x1d0))/0x9;if(_0xde0b84===_0x404e4f)break;else _0x360ca2['push'](_0x360ca2['shift']());}catch(_0x48c25f){_0x360ca2['push'](_0x360ca2['shift']());}}}(_0x430b,0x74ce6));const ST_GET=0x0,ST_SET=0x1,ST_ZERO_TOTAL=0x2,ST_ZERO_CPH_PAST=0x3,ST_ZERO_CPH=0x4,InitStat=()=>({'keyName':'','total':0x0,'cphPast':0x0,'cphNow':0x0,'hour':-0x1});let g_stat=InitStat(),g_elm_time_now,g_elm_total,g_elm_cph_past,g_elm_cph_now;const g_dt_now=new Date(),timerInit=setInterval(()=>{const _0x141a67=_0x4e16;try{if(!Boolean(document[_0x141a67(0x1ce)](_0x141a67(0x1c2)))){let _0xe158fb=document[_0x141a67(0x1c7)]('header\x20>\x20div:nth-child(1)');if(!Boolean(_0xe158fb))return;_0xe158fb['insertAdjacentHTML'](_0x141a67(0x1ae),_0x141a67(0x1d2)),_0xe158fb=document[_0x141a67(0x1ce)]('time-now'),_0xe158fb[_0x141a67(0x1ab)]('click',()=>{const _0x2933ac=_0x141a67,_0x3b97bf=document[_0x2933ac(0x1c7)](_0x2933ac(0x1d3));if(Boolean(_0x3b97bf))_0x3b97bf[_0x2933ac(0x1c3)][_0x2933ac(0x1d4)]=_0x3b97bf[_0x2933ac(0x1c3)][_0x2933ac(0x1d4)]==''?_0x2933ac(0x1d6):'';}),_0xe158fb=document['getElementById'](_0x141a67(0x1c1)),_0xe158fb[_0x141a67(0x1ab)](_0x141a67(0x1b4),()=>{StorageOperation(ST_ZERO_TOTAL);}),_0xe158fb=document[_0x141a67(0x1ce)](_0x141a67(0x1c9)),_0xe158fb[_0x141a67(0x1ab)](_0x141a67(0x1b4),()=>{StorageOperation(ST_ZERO_CPH_PAST);}),_0xe158fb=document[_0x141a67(0x1ce)]('btn-reset-cph'),_0xe158fb[_0x141a67(0x1ab)](_0x141a67(0x1b4),()=>{StorageOperation(ST_ZERO_CPH);}),g_elm_time_now=document[_0x141a67(0x1ce)](_0x141a67(0x1b8)),g_elm_total=document[_0x141a67(0x1ce)](_0x141a67(0x1d5)),g_elm_cph_past=document[_0x141a67(0x1ce)](_0x141a67(0x1b7)),g_elm_cph_now=document['getElementById'](_0x141a67(0x1da)),clearInterval(timerInit),setInterval(TimerStat,0x3e8);}}catch(_0x4c5742){console[_0x141a67(0x1bd)]('TimerInit:\x20'+_0x4c5742['message']),clearInterval(timerInit);}},0x3e8);document['addEventListener'](_0x1633a6(0x1b4),_0x444801=>{const _0x3c6052=_0x1633a6,_0xde836b=document[_0x3c6052(0x1cf)](_0x3c6052(0x1b3));let _0x38777c=_0xde836b[_0x3c6052(0x1d8)];while(_0x38777c--){const _0x3383e1=_0xde836b[_0x38777c];if(Boolean(_0x3383e1?.[_0x3c6052(0x1b0)]?.[_0x3c6052(0x1b1)](_0x3c6052(0x1c8)))){if(_0x3383e1['contains'](_0x444801[_0x3c6052(0x1af)])){g_dt_now[_0x3c6052(0x1bc)](Date[_0x3c6052(0x1bf)]());const _0x5e7f22=g_dt_now[_0x3c6052(0x1c6)]();g_stat[_0x3c6052(0x1b6)]<0x0||_0x5e7f22!=g_stat[_0x3c6052(0x1b6)]?(g_stat[_0x3c6052(0x1b6)]=_0x5e7f22,g_stat[_0x3c6052(0x1b9)]=g_stat['cphNow'],g_stat[_0x3c6052(0x1c5)]=0x1):(g_stat[_0x3c6052(0x1d5)]+=0x1,g_stat[_0x3c6052(0x1c5)]+=0x1);StorageOperation(ST_SET);break;}}}});function GetKeyName(){const _0x32323c=_0x1633a6;let _0x46f4e1=window[_0x32323c(0x1c4)]['href'][_0x32323c(0x1c0)](/(?<=\/service-dataset-collector-frontend\/project\/)\d+/);if(!Boolean(_0x46f4e1))return null;return'stat-'+_0x46f4e1[0x0];}function _0x430b(){const _0x1ccb5c=['keyName','count-per-hour','addEventListener','1370512GHwTbL','2346pcvOrD','afterend','target','textContent','includes','setItem','button.el-button','click','getItem','hour','count-per-hour-past','time-now','cphPast','toLocaleTimeString','stringify','setTime','warn','parse','now','match','btn-reset-total','dsc-s','style','location','cphNow','getHours','querySelector','Готово','btn-reset-cph-past','367068NCwbYw','794tSWdBt','10135KCgfNh','4621400gXLMid','getElementById','querySelectorAll','10736631lZoRnJ','300KILNnD','<div\x20id=\x22dsc-s\x22\x20style=\x22color:\x20#f8f8ff;\x20display:\x20inline-block;\x20font-family:\x20monospace;\x22><span\x20id=\x22time-now\x22\x20title=\x22Кликни\x20чтобы\x20показать\x20или\x20скрыть\x0aвстроенный\x20счётчик\x22\x20style=\x22padding-right:\x202em;\x22>?</span><span\x20id=\x22btn-reset-total\x22\x20title=\x22Кликни\x20чтобы\x20сбросить\x20этот\x20счётчик\x22>Итого:\x20</span><span\x20id=\x22total\x22\x20style=\x22padding-right:\x202em;\x22>?</span><span\x20id=\x22btn-reset-cph-past\x22\x20title=\x22Предыдущие\x20показания\x0aсчётчика\x20ТЧ\x22>ПП:\x20</span><span\x20id=\x22count-per-hour-past\x22\x20style=\x22padding-right:\x202em;\x22>?</span><span\x20id=\x22btn-reset-cph\x22\x20title=\x22Сколько\x20сделано\x0aза\x20текущий\x20час\x22>ТЧ:\x20</span><span\x20id=\x22count-per-hour\x22>?</span></div>','div.stats','display','total','none','807031CoBkTz','length'];_0x430b=function(){return _0x1ccb5c;};return _0x430b();}function _0x4e16(_0x1363f3,_0x4b17b2){const _0x430b4e=_0x430b();return _0x4e16=function(_0x4e165e,_0x1ab82b){_0x4e165e=_0x4e165e-0x1ab;let _0x403fb3=_0x430b4e[_0x4e165e];return _0x403fb3;},_0x4e16(_0x1363f3,_0x4b17b2);}function StorageOperation(_0xf57798){const _0x3f1253=_0x1633a6;let _0x544890=GetKeyName();if(!Boolean(_0x544890))return![];switch(_0xf57798){case ST_GET:if(_0x544890!=g_stat['keyName']){const _0x26a47d=localStorage[_0x3f1253(0x1b5)](_0x544890);Boolean(_0x26a47d)?g_stat=JSON[_0x3f1253(0x1be)](_0x26a47d):(g_stat=InitStat(),g_stat[_0x3f1253(0x1d9)]=_0x544890,localStorage[_0x3f1253(0x1b2)](_0x544890,JSON[_0x3f1253(0x1bb)](g_stat)));}break;case ST_SET:localStorage[_0x3f1253(0x1b2)](_0x544890,JSON['stringify'](g_stat));break;case ST_ZERO_TOTAL:g_stat[_0x3f1253(0x1d5)]=0x0,localStorage[_0x3f1253(0x1b2)](_0x544890,JSON['stringify'](g_stat));break;case ST_ZERO_CPH_PAST:g_stat[_0x3f1253(0x1b9)]=0x0,localStorage[_0x3f1253(0x1b2)](_0x544890,JSON[_0x3f1253(0x1bb)](g_stat));break;case ST_ZERO_CPH:g_stat[_0x3f1253(0x1c5)]=0x0,localStorage[_0x3f1253(0x1b2)](_0x544890,JSON[_0x3f1253(0x1bb)](g_stat));break;}return!![];}function TimerStat(){const _0x43f8c7=_0x1633a6;g_dt_now[_0x43f8c7(0x1bc)](Date[_0x43f8c7(0x1bf)]()),g_elm_time_now[_0x43f8c7(0x1b0)]=g_dt_now[_0x43f8c7(0x1ba)]();if(!StorageOperation(ST_GET)){g_elm_total[_0x43f8c7(0x1b0)]=g_elm_cph_past[_0x43f8c7(0x1b0)]=g_elm_cph_now['textContent']='?';return;}g_elm_total[_0x43f8c7(0x1b0)]=g_stat[_0x43f8c7(0x1d5)],g_elm_cph_past[_0x43f8c7(0x1b0)]=g_stat[_0x43f8c7(0x1b9)],g_elm_cph_now['textContent']=g_stat['cphNow'];}
